% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sim_data_generator.R
\name{sim_data_generator}
\alias{sim_data_generator}
\title{Simulate Hi-C count matrices with domain structure and zero inflation}
\usage{
sim_data_generator(
  n = 1000,
  const = 20,
  beta1 = -0.4,
  disp = 5,
  k = 20,
  a = 0.5,
  b = 1,
  pi1 = 0.2,
  pi2 = 0.4
)
}
\arguments{
\item{n}{Integer number of bins (matrix dimension). Default \code{1000}.}

\item{const}{Positive scaling constant representing diagonal and first
off-diagonal magnitude. Default \code{20}.}

\item{beta1}{Decay exponent in the biophysical law (should be negative),
default \code{-0.4}.}

\item{disp}{Positive over-dispersion factor for the Negative Binomial distribution:
we use \code{size = disp * mu}, so \code{Var = (1 + 1/disp) * mu}. Default \code{5}.}

\item{k}{Integer number of domains (at least 2 and at most \code{n}). Default \code{20}.}

\item{a, b}{Range for uniform domain effect scalars \eqn{\lambda_{b} \sim Unif(a,b)}.
Defaults \code{a = 0.5}, \code{b = 1}.}

\item{pi1}{Within-domain zero proportion in [0,1]. We zero out approximately
\verb{pi1 * 100\%} of upper-triangular entries below the domain median, which
yields about \code{pi1/2} zeros per domain after symmetrization. Default \code{0.2}.}

\item{pi2}{Outside-domain zero proportion in [0,1]. We zero out approximately
\verb{pi2 * 100\%} of the upper-triangular non-domain entries below their median,
yielding about \code{pi2/2} zeros outside domains after symmetrization. Default \code{0.4}.}
}
\value{
A list with:
\describe{
\item{simulated.matrix}{Symmetric \code{n} by \code{n} integer matrix of simulated counts.}
\item{true.bound}{Integer vector of length \code{k} giving cumulative domain endpoints
(last element is \code{n}). The domain intervals are \verb{(0, true.bound[1]]},
\verb{(true.bound[1], true.bound[2]]}, ...}
}
}
\description{
Generates a symmetric Hi-C contact matrix with:
(1) a distance-decay background following \eqn{\log(\text{count}) \propto \beta_{1} \log(\text{genomic distance})};
(2) domain (TAD-like) blocks with extra signal;
(3) zero inflation inside and outside domains; and
(4) negative-binomial overdispersion.
}
\details{
\strong{Background (distance-decay):} We build a mean matrix \code{D} with diagonal
\code{const} and the \code{i}-th off-diagonal proportional to \code{const * i^{beta1}}.
Counts are sampled as Negative Binomial with \code{mu = D}, \code{size = disp * D}.

\strong{Domain effects:} We draw \code{k-1} random boundaries and independent
\code{lambda_b ~ U(a,b)} domain scalars, then add Poisson noise with
\code{lambda = lambda_b * domain_block} inside each domain.

\strong{Zero inflation:} We zero a fraction of small (below-median) entries in
the \strong{upper triangle} inside each domain (rate \code{pi1}) and in the outside
non-domain region (rate \code{pi2}), then mirror to enforce symmetry.

#' @examples
set.seed(123)
sim1 <- sim_data_generator(n = 1000, const = 20, beta1 = -0.4, disp = 5, k = 20,
a = 0.5, b = 1, pi1 = 0.2, pi2 = 0.4)
dim(sim1$simulated.matrix)
}
