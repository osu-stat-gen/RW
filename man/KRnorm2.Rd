% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/KRnorm2.R
\name{KRnorm2}
\alias{KRnorm2}
\title{Knight–Ruiz (KR) normalization with zero-row handling}
\usage{
KRnorm2(B)
}
\arguments{
\item{B}{A numeric, square (n by n) matrix (e.g., a Hi-C contact map). May
contain \code{NA}s and rows/columns that sum to zero (after treating
\code{NA} as 0 for the purpose of zero-detection).}
}
\value{
A numeric matrix of the same dimension as \code{B}, KR-normalized.
Any zero rows/columns are restored with identity on their diagonal.
\code{NA} entries in the nonzero block are reintroduced in the output.
}
\description{
Performs matrix balancing via the Knight–Ruiz algorithm (KR normalization),
adapted for contact matrices that may contain all-zero rows/columns and
missing values. Zero rows/columns are temporarily removed for the solve and
inserted back afterward with their diagonal entries set to 1 (others 0).
}
\details{
The core iterations follow Knight & Ruiz (2012). Internally, the method
solves for a positive scaling vector \eqn{x} such that
\eqn{\mathrm{diag}(x) \, B \, \mathrm{diag}(x)} is doubly
stochastic (on the submatrix excluding zero rows/columns). We treat
\code{NA}s as zeros during the solve but place them back into the result
after scaling.
}
\examples{
set.seed(123)
M <- matrix(rpois(25, 5), 5, 5)
M[lower.tri(M)] <- t(M)[lower.tri(M)]
diag(M) <- 0
M[4, ] <- 0; M[, 4] <- 0              # a zero row/column
M.KR <- KRnorm2(M)
M.KR

}
\references{
Knight, P. A., & Ruiz, D. (2012). A fast algorithm for matrix balancing.
\emph{IMA Journal of Numerical Analysis}, 32(3), 906–929.
\doi{10.1093/imanum/drs019}
}
