% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Subsample.R
\name{Subsample}
\alias{Subsample}
\title{Subsample a contact matrix by multinomial thinning}
\usage{
Subsample(A, alpha = 0.1, seed = 2022)
}
\arguments{
\item{A}{Numeric, square, symmetric Hi-C contact matrix (non-negative counts).}

\item{alpha}{Fraction in \eqn{(0, 1]} giving the target proportion of total
contacts to retain (default \code{0.1}).}

\item{seed}{Optional integer seed for reproducibility (default \code{2022}).}
}
\value{
A symmetric matrix of the same dimension as \code{A}, containing the
subsampled counts. In expectation, each cell is scaled by \code{alpha}.
}
\description{
Randomly subsample approximately \eqn{\alpha \times 100\%} of the total
contacts from a symmetric Hi-C contact matrix. The subsample is drawn
proportionally to the original counts over the upper triangle (including
the main diagonal), then mapped back to a symmetric matrix.
}
\details{
Let \eqn{N=\sum_{i \le j} A_{ij}} be the total contacts in the upper triangle
(including diagonal). The procedure draws a single multinomial sample of size
\eqn{\lceil \alpha N \rceil} with cell probabilities
\eqn{p_{ij} = A_{ij}/N} over the upper triangle, then mirrors to enforce
symmetry. This is equivalent to \emph{multinomial thinning}, so
\eqn{\mathbb{E}[\tilde A_{ij}] \approx \alpha A_{ij}}.
}
\examples{
data(sim3.bulk)
data(sim3.sub)
sub <- Subsample(sim3.bulk, alpha=0.1, seed=2022)
# Check if the subsampled data matches with the one produced using the same seed
sum(abs(sub - sim3.sub))    # should = 0

}
