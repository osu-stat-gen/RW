% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/TopDom_star.R
\name{TopDom_star}
\alias{TopDom_star}
\title{Corrected function of TopDom for TAD detection}
\usage{
TopDom_star(matrix.file, window.size, outFile = NULL, statFilter = TRUE)
}
\arguments{
\item{matrix.file}{Either (a) an object of class \code{"TopDomData"} with
components \code{bins} (data.frame) and \code{counts} (numeric matrix), or
(b) a character path to a TopDom-format text file whose first 3â€“4 columns
describe bins \code{(chr, from.coord, to.coord[, id])} followed by an
\eqn{n \times n} symmetric contact matrix, where \code{n} is the number of bins.}

\item{window.size}{Integer (>=1). Diamond half-size used for local mean
calculations and subsequent statistics.}

\item{outFile}{Optional character prefix. If supplied, three files are
written: \code{<prefix>.binSignal}, \code{<prefix>.domain}, and
\code{<prefix>.bed}.}

\item{statFilter}{Logical; if \code{TRUE} (default), perform Step 3 statistical
filtering of candidate boundaries.}
}
\value{
A list with three components:
\describe{
\item{binSignal}{\code{data.frame} with per-bin signals and p-values
(\code{chr}, \code{from.coord}, \code{to.coord}, \code{local.ext},
\code{mean.cf}, \code{pvalue}).}
\item{domain}{\code{data.frame} of called domains.}
\item{bed}{\code{data.frame} with BED fields
\code{chrom}, \code{chromStart}, \code{chromEnd}, \code{name}.}
}
}
\description{
The function follows three steps:
\enumerate{
\item Compute per-bin contact frequency using a diamond window of \code{window.size}.
\item Detect gap regions and local extrema (candidate boundaries).
\item (Optional) Statistical filtering via diagonal-wise scaling and
Wilcoxon rank-sum p-values to reduce false positives.
}
}
\details{
\code{TopDom_star()} computes bin-level contact signals, detects local extrema as
candidate TAD boundaries, optionally performs statistical filtering, and
converts boundaries to domains (i.e., TADs).

This function is a modification the \code{TopDom()} function from the cran package built
by the original authors. The process regions are adjusted so that TopDom can handle
the existence of bins that never interact with other bins without excluding them
completely from the analysis.
}
\examples{
\dontrun{
data(sim1.P.obs)
N <- nrow(sim1.P.obs)
P.obs.input <- data.frame(rep(paste0("chr", as.character(1)), N),
                          (0:(N-1))*40000,
                          (1:N)*40000,
                          sim1.P.obs)
data.table::fwrite(P.obs.input, file="P_obs_TopDom.txt", col.names=FALSE, sep=" ")
P_obs_TopDom_data <- TopDom::readHiC("P_obs_TopDom.txt", binSize = 40000)
tryCatch({
  P_obs_TopDom <- TopDom_star(P_obs_TopDom_data, window.size=5)
  topdom.bound.P.obs <- P_obs_TopDom$domain[,"to.id"]},
  error = function(c) "error"
)
if(exists("P_obs_TopDom") == FALSE){
  topdom.bound.P.obs <- c(N)
}
}
}
\references{
Shin, H., Shi, Y., Dai, C., Tjong, H., Gong, K., Alber, F., & Zhou, X. J. (2016).
TopDom: an efficient and deterministic method for identifying topological domains in genomes.
\emph{Nucleic Acids Research}, 44(7), e70. \doi{10.1093/nar/gkv1505}
PMCID: \href{https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4838359}{PMC4838359};
PMID: \href{https://pubmed.ncbi.nlm.nih.gov/26704975/}{26704975}.
}
\seealso{
\code{\link[TopDom]{TopDom}}
}
